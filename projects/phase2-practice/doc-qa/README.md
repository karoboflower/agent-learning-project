# æ–‡æ¡£é—®ç­” Agent (Document Q&A Agent)

> åŸºäºRAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰çš„æ™ºèƒ½æ–‡æ¡£é—®ç­”ç³»ç»Ÿ

[![Next.js](https://img.shields.io/badge/Next.js-14.0-black.svg)](https://nextjs.org/)
[![TypeScript](https://img.shields.io/badge/TypeScript-5.3-blue.svg)](https://www.typescriptlang.org/)
[![LangChain](https://img.shields.io/badge/LangChain.js-0.3-orange.svg)](https://js.langchain.com/)
[![Status](https://img.shields.io/badge/Status-In%20Progress-yellow.svg)]()

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸ“¤ **æ–‡æ¡£ä¸Šä¼ ** - æ”¯æŒPDFã€Markdownã€TXTæ ¼å¼
- ğŸ” **æ™ºèƒ½æ£€ç´¢** - åŸºäºå‘é‡ç›¸ä¼¼åº¦çš„è¯­ä¹‰æ£€ç´¢
- ğŸ’¬ **æ™ºèƒ½é—®ç­”** - RAGæŠ€æœ¯å®ç°ç²¾å‡†ç­”æ¡ˆç”Ÿæˆ
- ğŸ“š **æ–‡æ¡£ç®¡ç†** - æ–‡æ¡£åˆ—è¡¨ã€åˆ é™¤ã€çŠ¶æ€ç®¡ç†
- ğŸ“– **æ¥æºå¼•ç”¨** - å›ç­”é™„å¸¦åŸæ–‡æ¡£å¼•ç”¨

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
npm install
# æˆ–
pnpm install
```

### 2. é…ç½®ç¯å¢ƒå˜é‡

```bash
cp .env.example .env
# ç¼–è¾‘.envæ–‡ä»¶ï¼Œå¡«å…¥OpenAI APIå¯†é’¥
```

### 3. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
npm run dev
```

è®¿é—® `http://localhost:3000`

## ğŸ“¦ æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç”¨é€” | ç‰ˆæœ¬ |
|------|------|------|
| Next.js | Reactæ¡†æ¶ | ^14.0.0 |
| TypeScript | ç±»å‹ç³»ç»Ÿ | ^5.3.0 |
| TailwindCSS | æ ·å¼æ¡†æ¶ | ^3.4.0 |
| LangChain.js | AIæ¡†æ¶ | ^0.3.0 |
| HNSWLib | å‘é‡æ•°æ®åº“ | ^3.0.0 |
| pdf-parse | PDFè§£æ | ^1.1.1 |
| marked | Markdownè§£æ | ^11.0.0 |

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
doc-qa/
â”œâ”€â”€ app/                      # Next.js App Router
â”‚   â”œâ”€â”€ layout.tsx           # æ ¹å¸ƒå±€
â”‚   â”œâ”€â”€ page.tsx             # é¦–é¡µ
â”‚   â”œâ”€â”€ qa/                  # é—®ç­”é¡µé¢
â”‚   â””â”€â”€ api/                 # APIè·¯ç”±
â”‚       â”œâ”€â”€ upload/          # æ–‡æ¡£ä¸Šä¼ API
â”‚       â”œâ”€â”€ documents/       # æ–‡æ¡£ç®¡ç†API
â”‚       â””â”€â”€ ask/             # é—®ç­”API
â”œâ”€â”€ components/               # Reactç»„ä»¶
â”‚   â”œâ”€â”€ DocumentUpload.tsx   # æ–‡æ¡£ä¸Šä¼ ç»„ä»¶
â”‚   â”œâ”€â”€ DocumentList.tsx     # æ–‡æ¡£åˆ—è¡¨ç»„ä»¶
â”‚   â”œâ”€â”€ QuestionInput.tsx    # é—®é¢˜è¾“å…¥ç»„ä»¶
â”‚   â””â”€â”€ AnswerDisplay.tsx    # ç­”æ¡ˆæ˜¾ç¤ºç»„ä»¶
â”œâ”€â”€ lib/                      # æ ¸å¿ƒåº“
â”‚   â”œâ”€â”€ services/            # æœåŠ¡å±‚
â”‚   â”‚   â”œâ”€â”€ vector-db.ts    # å‘é‡æ•°æ®åº“æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ document-processor.ts  # æ–‡æ¡£å¤„ç†æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ rag.ts          # RAGæœåŠ¡
â”‚   â”‚   â””â”€â”€ document-store.ts  # æ–‡æ¡£å­˜å‚¨æœåŠ¡
â”‚   â”œâ”€â”€ types/               # TypeScriptç±»å‹
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â””â”€â”€ utils/               # å·¥å…·å‡½æ•°
â”œâ”€â”€ public/                   # é™æ€èµ„æº
â”œâ”€â”€ data/                     # æ•°æ®å­˜å‚¨ï¼ˆæœ¬åœ°ï¼‰
â”‚   â”œâ”€â”€ documents.json       # æ–‡æ¡£å…ƒæ•°æ®
â”‚   â””â”€â”€ vector-store/        # å‘é‡å­˜å‚¨
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ next.config.js
â””â”€â”€ README.md
```

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### 1. æ–‡æ¡£ä¸Šä¼ ä¸å¤„ç†

- æ”¯æŒæ–‡ä»¶ç±»å‹ï¼šPDF, Markdown (.md), çº¯æ–‡æœ¬ (.txt)
- æ–‡ä»¶å¤§å°é™åˆ¶ï¼š10MB
- è‡ªåŠ¨è§£æå’Œæ–‡æœ¬æå–
- æ™ºèƒ½æ–‡æœ¬åˆ†å—ï¼ˆChunk Size: 1000, Overlap: 200ï¼‰

### 2. å‘é‡åŒ–å­˜å‚¨

- ä½¿ç”¨OpenAI Embeddingsï¼ˆtext-embedding-3-smallï¼‰
- æœ¬åœ°å‘é‡æ•°æ®åº“ï¼ˆHNSWLibï¼‰
- ç›¸ä¼¼åº¦æ£€ç´¢
- Top-Kæ£€ç´¢ï¼ˆé»˜è®¤5ä¸ªç»“æœï¼‰

### 3. RAGé—®ç­”

- æ£€ç´¢ç›¸å…³æ–‡æ¡£ç‰‡æ®µ
- æ„å»ºä¸Šä¸‹æ–‡Prompt
- GPT-4ç”Ÿæˆå›ç­”
- å¼•ç”¨åŸæ–‡æ¡£æ¥æº

### 4. æ–‡æ¡£ç®¡ç†

- æ–‡æ¡£åˆ—è¡¨å±•ç¤º
- æ–‡æ¡£åˆ é™¤åŠŸèƒ½
- å¤„ç†çŠ¶æ€æ˜¾ç¤º
- æ–‡æ¡£ç»Ÿè®¡ä¿¡æ¯

## ğŸ¨ å·¥ä½œæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¸Šä¼ æ–‡æ¡£    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ–‡æ¡£è§£æ    â”‚ â† PDF/Markdown/TXTè§£æ
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ–‡æœ¬åˆ†å—    â”‚ â† RecursiveCharacterTextSplitter
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‘é‡åŒ–      â”‚ â† OpenAI Embeddings
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å­˜å‚¨åˆ°å‘é‡DB â”‚ â† HNSWLib
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç”¨æˆ·æé—® â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚
                   â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  å‘é‡æ£€ç´¢    â”‚
            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  æ„å»ºPrompt  â”‚
            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  LLMç”Ÿæˆç­”æ¡ˆ â”‚ â† GPT-4
            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  è¿”å›ç­”æ¡ˆ+æ¥æºâ”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” ç¯å¢ƒå˜é‡

| å˜é‡å | è¯´æ˜ | å¿…éœ€ | é»˜è®¤å€¼ |
|--------|------|------|--------|
| `OPENAI_API_KEY` | OpenAI APIå¯†é’¥ | âœ… | - |
| `OPENAI_EMBEDDING_MODEL` | Embeddingæ¨¡å‹ | âŒ | text-embedding-3-small |
| `OPENAI_CHAT_MODEL` | èŠå¤©æ¨¡å‹ | âŒ | gpt-4 |
| `CHUNK_SIZE` | åˆ†å—å¤§å° | âŒ | 1000 |
| `CHUNK_OVERLAP` | åˆ†å—é‡å  | âŒ | 200 |
| `TOP_K` | æ£€ç´¢ç»“æœæ•° | âŒ | 5 |
| `SIMILARITY_THRESHOLD` | ç›¸ä¼¼åº¦é˜ˆå€¼ | âŒ | 0.7 |
| `MAX_FILE_SIZE` | æœ€å¤§æ–‡ä»¶å¤§å°(å­—èŠ‚) | âŒ | 10485760 |
| `VECTOR_STORE_PATH` | å‘é‡å­˜å‚¨è·¯å¾„ | âŒ | ./data/vector-store |

## ğŸ“– APIæ–‡æ¡£

### POST /api/upload

ä¸Šä¼ å¹¶å¤„ç†æ–‡æ¡£

**è¯·æ±‚**:
- Content-Type: multipart/form-data
- Body: FormData with `file` field

**å“åº”**:
```json
{
  "success": true,
  "document": {
    "id": "uuid",
    "name": "document.pdf",
    "type": "pdf",
    "size": 1024000,
    "chunks": 15,
    "status": "ready"
  }
}
```

### GET /api/documents

è·å–æ‰€æœ‰æ–‡æ¡£åˆ—è¡¨

**å“åº”**:
```json
{
  "documents": [
    {
      "id": "uuid",
      "name": "document.pdf",
      "type": "pdf",
      "size": 1024000,
      "uploadedAt": "2026-01-27T...",
      "status": "ready",
      "chunks": 15
    }
  ]
}
```

### POST /api/ask

æé—®å¹¶è·å–ç­”æ¡ˆ

**è¯·æ±‚**:
```json
{
  "question": "ä»€ä¹ˆæ˜¯RAG?"
}
```

**å“åº”**:
```json
{
  "id": "uuid",
  "question": "ä»€ä¹ˆæ˜¯RAG?",
  "answer": "RAGæ˜¯æ£€ç´¢å¢å¼ºç”Ÿæˆ...",
  "sources": [
    {
      "documentId": "uuid",
      "documentName": "document.pdf",
      "content": "...",
      "score": 0.95
    }
  ],
  "timestamp": "2026-01-27T..."
}
```

## ğŸ§ª æµ‹è¯•

```bash
# è¿è¡Œæµ‹è¯•
npm run test

# ç±»å‹æ£€æŸ¥
npm run type-check

# Lintæ£€æŸ¥
npm run lint
```

## ğŸ›£ï¸ å¼€å‘è·¯çº¿å›¾

### å·²å®Œæˆ âœ…
- [x] Task 2.2.1 - é¡¹ç›®åˆå§‹åŒ–
- [x] Task 2.2.2 - é›†æˆå‘é‡æ•°æ®åº“
- [x] Task 2.2.3 - å®ç°æ–‡æ¡£å¤„ç†
- [x] Task 2.2.4 - å®ç°RAGåŠŸèƒ½
- [x] Task 2.2.5 - å®ç°UIç•Œé¢

### è¿›è¡Œä¸­ ğŸš§
- [ ] Task 2.2.6 - ä¼˜åŒ–å’Œæµ‹è¯•

### è®¡åˆ’ä¸­ ğŸ“‹
- [ ] æ”¯æŒæ›´å¤šæ–‡æ¡£æ ¼å¼ï¼ˆWord, Excelç­‰ï¼‰
- [ ] å¤šæ–‡ä»¶å¯¹è¯ä¸Šä¸‹æ–‡
- [ ] å†å²å¯¹è¯è®°å½•
- [ ] æ–‡æ¡£å†…å®¹é¢„è§ˆ
- [ ] å¯¼å‡ºå¯¹è¯è®°å½•

## âš ï¸ æ³¨æ„äº‹é¡¹

### å‘é‡æ•°æ®åº“é€‰æ‹©

æœ¬é¡¹ç›®ä½¿ç”¨HNSWLibä½œä¸ºæœ¬åœ°å‘é‡æ•°æ®åº“ï¼Œé€‚åˆï¼š
- âœ… å¼€å‘å’Œæµ‹è¯•
- âœ… å°è§„æ¨¡æ•°æ®ï¼ˆ<10ä¸‡å‘é‡ï¼‰
- âœ… å•æœºéƒ¨ç½²

ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨ï¼š
- **Pinecone** - äº‘æ‰˜ç®¡ï¼Œæ˜“ç”¨
- **Weaviate** - å¼€æºï¼ŒåŠŸèƒ½ä¸°å¯Œ
- **Qdrant** - é«˜æ€§èƒ½ï¼Œå¼€æº

### APIå¯†é’¥å®‰å…¨

- âš ï¸ ä¸è¦åœ¨å®¢æˆ·ç«¯æš´éœ²APIå¯†é’¥
- âœ… ä½¿ç”¨Server Actionså¤„ç†APIè°ƒç”¨
- âœ… åœ¨æœåŠ¡å™¨ç«¯åŠ è½½ç¯å¢ƒå˜é‡

### æ•°æ®å­˜å‚¨

- å½“å‰ä½¿ç”¨JSONæ–‡ä»¶å­˜å‚¨å…ƒæ•°æ®
- ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨PostgreSQL/MongoDB
- å‘é‡æ•°æ®å®šæœŸå¤‡ä»½

## ğŸ“š å­¦ä¹ èµ„æº

- [LangChain.jsæ–‡æ¡£](https://js.langchain.com/)
- [RAGæŠ€æœ¯ä»‹ç»](https://www.pinecone.io/learn/retrieval-augmented-generation/)
- [Next.jsæ–‡æ¡£](https://nextjs.org/docs)
- [HNSWLibä»‹ç»](https://github.com/nmslib/hnswlib)

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

## ğŸ“ è®¸å¯è¯

MIT License

---

**å®Œæˆæ—¥æœŸ**: 2026-01-27
**ç‰ˆæœ¬**: v1.0.0 (In Progress)
**çŠ¶æ€**: ğŸš§ Task 2.2.1 - 2.2.4 å·²å®Œæˆ
**ä¸‹ä¸€æ­¥**: Task 2.2.5 - å®ç°UIç•Œé¢
